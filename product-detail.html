<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Chi tiáº¿t sáº£n pháº©m - ÄÄƒng Äáº¡i Bakery</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">

</head>

<body>
    <!-- ===== HEADER ===== -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
        <div class="container">
            <a class="navbar-brand fw-bold text-danger fs-3" href="index.html">
                <i class="fa-solid fa-cake-candles me-2"></i>ÄÄƒng Äáº¡i Bakery
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav align-items-center">
                    <li class="nav-item"><a class="nav-link active" href="index.html">Trang chá»§</a></li>
                    <li class="nav-item"><a class="nav-link" href="product.html">Sáº£n pháº©m</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">LiÃªn há»‡</a></li>
                    <li class="nav-item ms-3">
                        <a class="btn btn-danger rounded-pill px-3" href="cart.html">ğŸ›’ Giá» hÃ ng</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- MAIN -->
    <main class="pt-5 mt-5">
        <div class="container py-5" id="detail-wrap">
            <p class="text-center text-muted">Äang táº£i sáº£n pháº©m...</p>
        </div>

        <div class="container mt-5">
            <h4 class="fw-bold mb-3">Sáº£n pháº©m liÃªn quan</h4>
            <div id="related-products" class="row g-4"></div>
        </div>
    </main>

    <!-- ===== FOOTER ===== -->
    <footer class="mt-5 pt-5 pb-3">
        <div class="container text-center">
            <h5 class="fw-bold text-uppercase mb-3">ÄÄƒng Äáº¡i Bakery</h5>
            <p>Ngá»t ngÃ o má»—i ngÃ y â€” nÆ¡i nhá»¯ng chiáº¿c bÃ¡nh Ä‘Æ°á»£c lÃ m tá»« tÃ¬nh yÃªu & niá»m Ä‘am mÃª ğŸ°</p>

            <div class="footer-social mb-3">
                <a target="_blank" href="https://facebook.com"><i class="fa-brands fa-facebook"></i></a>
                <a target="_blank" href="https://instagram.com"><i class="fa-brands fa-instagram"></i></a>
                <a target="_blank" href="https://tiktok.com"><i class="fa-brands fa-tiktok"></i></a>
            </div>

            <p class="small mb-0">ğŸ“ 123 Nguyá»…n VÄƒn Cá»«, Quáº­n 5, TP.HCM | ğŸ“ 0909 109 343 | âœ‰ï¸ lienhe@dangdaibakery.vn
            </p>
            <hr class="my-3" style="opacity:0.2;">
            <p class="mb-0 small">Â© 2025 ÄÄƒng Äáº¡i Bakery - All rights reserved.</p>
        </div>
    </footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            const params = new URLSearchParams(window.location.search);
            const productId = params.get("id");
            const detailWrap = document.getElementById("detail-wrap");
            const relatedWrap = document.getElementById("related-products");

            if (!productId) {
                detailWrap.innerHTML = "<p class='text-center text-danger'>KhÃ´ng tÃ¬m tháº¥y sáº£n pháº©m.</p>";
                return;
            }

            // --- Láº¥y prefix Ä‘á»ƒ biáº¿t danh má»¥c (VD: MC -> macaron, BL -> bonglan)
            const prefix = productId.slice(0, 2).toUpperCase();
            const categoryMap = {
                BL: "bonglan",
                CK: "cookies",
                DN: "donut",
                MC: "macaron",
                TM: "tiramisu"
            };
            const category = categoryMap[prefix] || "unknown";

            try {
                const res = await fetch(`cakes/${category}.html`);
                if (!res.ok) throw new Error("KhÃ´ng tÃ¬m tháº¥y file danh má»¥c");

                const html = await res.text();
                const temp = document.createElement("div");
                temp.innerHTML = html;
                const product = temp.querySelector(`.product-item[data-id="${productId}"]`);

                if (!product) {
                    detailWrap.innerHTML = "<p class='text-center text-muted'>KhÃ´ng tÃ¬m tháº¥y sáº£n pháº©m nÃ y ğŸ˜¢</p>";
                    return;
                }

                // Láº¥y thÃ´ng tin
                const img = product.querySelector("img").getAttribute("src");
                const name = product.querySelector(".card-title").textContent;
                const price = product.dataset.price;
                const desc = product.dataset.desc || "MÃ´ táº£ sáº£n pháº©m Ä‘ang Ä‘Æ°á»£c cáº­p nháº­t.";
                const date = product.dataset.date || "2025-10-15";

                // Render chi tiáº¿t
                detailWrap.innerHTML = `
        <div class="row g-4 align-items-start">
          <div class="col-md-6">
            <img src="${img}" alt="${name}" class="img-fluid shadow-sm">
          </div>
          <div class="col-md-6">
            <h2>${name}</h2>
            <p class="text-muted mb-1">Danh má»¥c: <span class="fw-semibold text-capitalize">${category}</span></p>
            <p class="price mb-3">${new Intl.NumberFormat('vi-VN').format(price)}â‚«</p>
            <p class="text-secondary mb-4">${desc}</p>
            <div class="d-flex align-items-center mb-4">
              <label for="qty" class="me-2 fw-semibold">Sá»‘ lÆ°á»£ng:</label>
              <input type="number" id="qty" value="1" min="1" class="form-control text-center" style="width: 80px;">
            </div>
            <div class="d-flex gap-3">
              <button id="addToCart" class="btn btn-danger">ğŸ›’ ThÃªm vÃ o giá»</button>
              <a href="cart.html" class="btn btn-outline-dark">Mua ngay</a>
            </div>
          </div>
        </div>
      `;

                // ThÃªm sá»± kiá»‡n thÃªm giá» hÃ ng
                document.getElementById("addToCart").addEventListener("click", () => {
                    const qty = parseInt(document.getElementById("qty").value) || 1;
                    const cart = JSON.parse(localStorage.getItem("cart") || "[]");
                    const existing = cart.find(p => p.id === productId);
                    if (existing) existing.qty += qty;
                    else cart.push({ id: productId, name, price, img, category, qty });
                    localStorage.setItem("cart", JSON.stringify(cart));
                    alert("ğŸ§ ÄÃ£ thÃªm vÃ o giá» hÃ ng!");
                });

                // --- Sáº£n pháº©m liÃªn quan ---
                const related = Array.from(temp.querySelectorAll(".product-item"))
                    .filter(p => p.dataset.id !== productId)
                    .slice(0, 4);

                if (related.length === 0) {
                    relatedWrap.innerHTML = "<p class='text-muted'>KhÃ´ng cÃ³ sáº£n pháº©m liÃªn quan.</p>";
                } else {
                    relatedWrap.innerHTML = related.map(r => `
          <div class="col-md-3 col-6">
            <div class="card border-0 shadow-sm h-100">
              <img src="${r.querySelector("img").src}" class="card-img-top" alt="">
              <div class="card-body text-center">
                <h6 class="card-title">${r.querySelector(".card-title").textContent}</h6>
                <p class="text-danger mb-2 fw-semibold">${new Intl.NumberFormat('vi-VN').format(r.dataset.price)}â‚«</p>
                <a href="product-detail.html?id=${r.dataset.id}" class="btn btn-outline-danger btn-sm">Xem chi tiáº¿t</a>
              </div>
            </div>
          </div>
        `).join("");
                }

            } catch (err) {
                console.error(err);
                detailWrap.innerHTML = "<p class='text-center text-danger'>KhÃ´ng thá»ƒ táº£i thÃ´ng tin sáº£n pháº©m.</p>";
            }
        });
    </script>
</body>

</html>